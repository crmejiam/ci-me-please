language: java
install:
- sudo apt install default-jre
- gradle assemble
os: linux
script: 'if [ "$TRAVIS_PULL_REQUEST" != "false" ]; then bash ./travis/run_on_pull_requests;fi'
branches:
  only:
    - main

jobs:
  include:
  - stage: Checkout
  - stage: Test
    script: "./gradlew test"
  - stage: Build
    script:
    - "./gradlew build"
    - "./gradlew run"
  - stage: Deploy
    deploy:
      provider: heroku
      api_key:
        secure: g+v9LHv8+DEqmlZWBkLTogLkEMKzVLR1kvqOHVz8OTWZeTIBFsiLBJX9lhzxR3CYGyBa7lkcSwM87g38DZTpeK/q+ZWvLiHmd/dlKEDQOMFafrRn5Q2u8xDJO8vKsWTDDzVeK7EzbK6iyKZDsixjTans97NWmPvNxJIn2aHtmdUGqWrVHbD9LbROjuiCVAA37v8WwrU8BOJpb6/vxz/mnyLQ22fD1htkeQdhN0BrjTb27T8KfP6gielNXikG44Ax0eZrh3XKYWEU3+PvMw3Z1I9Qsv3XjAJco7g2XafNGabHctNHq3736UxlxgexfYK9qFLEAGjgnvPyygLqSCMAUnsn8sIBxjgz7oFDD+N7EAVlmGeaiD/mta4qJzyMa900eq/uqFpwyQfursM+JAriCwhTPMD0Dlz+IpvjzhVfMLtvA6Qblh989EdrIcC8DxvCpCvgRf0SpZLNpaNlLRt9Uj0nk056vheR0tWoWHVFLgTy+imaPWbrNoRbInFwae6YspooezqkKKnOmd2CgrWwb7LGEjf2GpcJfaS1Hd0/07NwttwqwI/AU22iaYRkbZKpaRWeQ7+i8pvsrURoHkPIB6qwAptIbS5kmt/vmxEzuYFfB3TjFROc/E6ModU7SiL5Sr5LQEEV08YRCZZP5XIB+TMbqqIcaFzjOnVzaXhE6vU=
      app: ci-me-please-app
      on:
        repo: crmejiam/ci-me-please
        all_branches: true
notifications:
  slack:
    secure: aR8fi2vtSuFQ0uDeC7iQzUkuXosXGuYaEB23cBtqkRrCYfm7r6I5T8Gygd7C8kZukvYiiuZd2MdWn7DAyQWW+ptpwQwevzUeUt8HuQb3YT3YznZAiDjmLkEnTBk6l0glvR519SVNlIfu8ocGGY1fk+TdCSoUs/deR/F01idUBaqYTfQRsvWngzpAcc43hDyMpB0eqYvfKVYkt+gJY10Jj/o4UluW7p86MlxhZWmVybqGQrIsikq2BDTuiZcQbYxSPruArTt+D4/33qXjFPpM2+BweLSAhvSdny8iaERa2eLu86rK2wcJbAKoWFQbXnooAAJwS/G08zGJFjCGKSPAHdEgmqSWx0wHgDkq/rtaf0P5DQpjA98OWlNrDoxXH+2czLDj0Zfg8Vr+uJ6WXv/QqN7KGRcyGpPzeqYTEIrLXddT0vWQnKppKPpa7vBz0xRaCL2m1phESsycuI87v1Q+2QZXYJWNIqbAMQYJc/lingWiKUDOGpYur9kG+BRaDVCNslBuoypkoZ3+L05R5iGBJnk2eVhZFUahWCwhw/dcn3+8DvJsbS1Noftd5WslaYes56sjgdf/of1VDwKMLXWCFCxBld687tdL7ThUJIhi5KZEdd8RMkNtSfZiK+zOykYSRyBS8jXHtm1j9Uin/toHOLqjysHE+yalBcPB5tsnSa8=
  email: false
services:
- docker
after_success:
- echo 'Yay! Success!'
after_failure:
- echo 'Damn... Failure'
